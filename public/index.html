<!DOCTYPE html>
<!--indextest.html-->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="./assets/images/icons/swf.png" />
  <link rel="apple-touch-icon" href="./assets/images/icons/swf.png" />
  <link rel="icon" type="image/png" href="./assets/images/icons/swf.png" />
  <title>Selector</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #fff;
      font-family: system-ui, sans-serif;
    }

    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    form {
      display: flex;
      align-items: center;
      gap: 1rem;
      z-index: 1;
    }

    #pageInput {
      padding: 0.55rem 0.8rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 0.375rem;
      min-width: 14rem;
    }

    button {
      padding: 0.55rem 1.25rem;
      font-size: 1rem;
      border: none;
      border-radius: 0.375rem;
      cursor: pointer;
      background: #000;
      color: #fff;
    }

    button:hover {
      filter: brightness(1.1);
    }

    #recentGames {
      position: absolute;
      right: 1rem;
      bottom: 5rem;
      background: #f0f0f0;
      padding: 1rem;
      border-radius: 0.5rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      max-width: 200px;
      font-size: 0.9rem;
    }

    #recentGames h3 {
      margin-top: 0;
      font-size: 1rem;
    }

    #recentGames ul {
      padding-left: 1rem;
      margin: 0;
    }

    #infoBtn {
      position: absolute;
      bottom: 1rem;
      left: 1rem;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #000;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      cursor: pointer;
    }

    #infoBtn:hover::after {
      content: "Info about the games and how this works";
      position: absolute;
      bottom: 110%;
      left: 0;
      background: #000;
      color: #fff;
      padding: 0.5rem;
      font-size: 0.8rem;
      white-space: nowrap;
      border-radius: 0.25rem;
    }
    #recentList li {
  cursor: pointer;
  color: #0077cc;
}
#recentList li:hover {
  text-decoration: underline;
}
  </style>
</head>
<body>
  <form id="pageForm" autocomplete="off">
    <input list="pages" id="pageInput" placeholder="Choose a gameâ€¦" required />
    <datalist id="pages">
      <option value="Soldier Diary"    data-url="./players/soldierdiary.html"></option>
      <option value="PC Breakdown"   data-url="./players/pcbreakdown.html"></option>
      <option value="Mini Commando" data-url="./players/minicommando.html"></option>
      <option value="Papa's Pizzeria"    data-url="./players/papaspizzeria.html"></option>
      <option value="Bloxorz" data-url="./players/bloxorz.html"></option>
      <option value="Bloons Tower Defense" data-url="./players/bloonstd.html"></option>
      <option value="Bloons Tower Defense 2" data-url="./players/bloonstd2.html"></option>
      <option value="Factory Balls" data-url="./players/factoryballs.html"></option>
      <option value="Factory Balls 2" data-url="./players/factoryballs2.html"></option>
      <option value="Whack your Boss" data-url="./players/whackyourboss.html"></option>
      <option value="Whack your Computer" data-url="./players/whackyourcomputer.html"></option>
      <option value="Steak and Jake" data-url="./players/steakandjake.html"></option>
      <option value="Sugar Sugar" data-url="./players/sugarsugar.html"></option>
      <option value="Sugar Sugar 2" data-url="./players/sugarsugar2.html"></option>
      <option value="Airport Tycoon" data-url="./players/airporttycoon.html"></option>
      <option value="Jack Smith" data-url="./players/jacksmith.html"></option>
      <option value="Papa's Freezeria" data-url="./players/papasfreezeria.html"></option>
      <option value="Papa's Burgeria" data-url="./players/papasburgeria.html"></option>
      <option value="Talking Tom Cat 2" data-url="./players/talkingtomcat2.html"></option>
      <option value="American Apple Pie" data-url="./players/americanapplepie.html"></option>
    </datalist>
    <button type="submit">Play!</button>
  </form>

  <div id="recentGames">
    <h3>Recent Games (Latest First)</h3>
    <ol id="recentList"></ol>
  </div>

  <div id="infoBtn">i</div>

  <script>
  const maxRecent = 15;

  function loadRecentGames() {
    const recent = JSON.parse(localStorage.getItem("recentGames") || "[]");
    const recentList = document.getElementById("recentList");
    recentList.innerHTML = "";
    recent.forEach(name => {
      const li = document.createElement("li");
      li.textContent = name;
      li.style.cursor = "pointer";
      li.addEventListener("click", () => {
        const option = Array.from(document.querySelectorAll("#pages option"))
          .find(o => o.value.toLowerCase() === name.toLowerCase());
        if (option) window.location.href = option.dataset.url;
        else alert("Game not found.");
      });
      recentList.appendChild(li);
    });
  }

  window.addEventListener("DOMContentLoaded", () => {
    // Sort datalist alphabetically
    const datalist = document.getElementById("pages");
    const options = Array.from(datalist.querySelectorAll("option"));
    options.sort((a, b) => a.value.toLowerCase().localeCompare(b.value.toLowerCase()));
    datalist.innerHTML = "";
    options.forEach(option => datalist.appendChild(option));

    loadRecentGames();
  });

  document.getElementById("pageForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const typed = document.getElementById("pageInput").value.trim();
    const options = document.querySelectorAll("#pages option");

    for (const o of options) {
      if (o.value.toLowerCase() === typed.toLowerCase()) {
        let recent = JSON.parse(localStorage.getItem("recentGames") || "[]");
        recent = recent.filter(v => v.toLowerCase() !== typed.toLowerCase());
        recent.unshift(o.value); // Use original casing from the datalist
        if (recent.length > maxRecent) recent = recent.slice(0, maxRecent);
        localStorage.setItem("recentGames", JSON.stringify(recent));
        loadRecentGames(); // Update list before redirect (in case you cancel navigation)
        window.location.href = o.dataset.url;
        return;
      }
    }

    alert("Please select a valid page from the list.");
  });

  const input = document.getElementById("pageInput");
  input.addEventListener("focus", () => {
    input.dispatchEvent(new KeyboardEvent("keydown", { key: "ArrowDown" }));
  });
</script>
</body>
</html>
