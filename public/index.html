<!DOCTYPE html>
<!--indextest.html added the info button and recent games list-->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="./assets/images/icons/swf.png" />
  <link rel="apple-touch-icon" href="./assets/images/icons/swf.png" />
  <link rel="icon" type="image/png" href="./assets/images/icons/swf.png" />
  <link rel="x-icon" type="image/png" href="./assets/images/icons/swf.png" />
  <title>Online Maths Club</title>
  <link rel="stylesheet" type="text/css" href="./assets/css/selector.css" />
</head>
<body>
  <!-- Math Background Animation -->
  <div class="math-bg" id="mathBackground"></div>

  <form id="pageForm" autocomplete="off">
    <input list="pages" id="pageInput" placeholder="Choose a maths club…" required />
    <datalist id="pages"></datalist>
    <button type="submit">Join!</button>
  </form>

  <div id="recentGames">
    <h3>Recent Clubs (Latest First)</h3>
    <ol id="recentList"></ol>
  </div>

  <!-- Bottom Left Button Container -->
  <div id="bottomLeftButtons">
    <div id="infoBtn" title="More Information">i</div>
    <div class="logo-btn" id="githubBtn" title="GitHub Repository">
      <svg viewBox="0 0 24 24">
        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
      </svg>
    </div>
    <div class="logo-btn" id="mathBtn" title="Mathematics Resources">
      <svg viewBox="0 0 24 24">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>
    </div>
    <div class="logo-btn" id="calculatorBtn" title="Calculator">
      <svg viewBox="0 0 24 24">
        <path d="M7,2H17A2,2 0 0,1 19,4V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V4A2,2 0 0,1 7,2M7,4V8H17V4H7M7,10V12H9V10H7M11,10V12H13V10H11M15,10V12H17V10H15M7,14V16H9V14H7M11,14V16H13V14H11M15,14V16H17V14H15M7,18V20H9V18H7M11,18V20H13V18H11M15,18V20H17V18H15Z"/>
      </svg>
    </div>
    <div class="logo-btn" id="settingsBtn" title="Settings">
      <svg viewBox="0 0 24 24">
        <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11.03L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11.03C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
      </svg>
    </div>
    <div class="logo-btn" id="developerBtn" title="Developer Website">
      <svg viewBox="0 0 24 24">
        <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
      </svg>
    </div>
  </div>
<script>
  /* ---------- CONFIG ---------- */
  const maxRecent = 15;          // how many recent games to remember
  const optionsURL = "/assets/games.html";  // where the option list lives

  /* ---------- MATH BACKGROUND ---------- */
  function createMathSymbols() {
    const mathSymbols = [
      // Basic symbols (SVG)
      '<svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>',
      '<svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',
      '<svg viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4H6v2h12v-2z"/></svg>',
      '<svg viewBox="0 0 24 24"><path d="M19 10H5v2h14v-2zm0 4H5v2h14v-2z"/></svg>',
      '<svg viewBox="0 0 24 24"><path d="M18.6 6.62c-1.44 0-2.8.56-3.77 1.53L12 10.66 10.48 9.14C9.51 8.17 8.15 7.61 6.71 7.61c-2.88 0-5.22 2.34-5.22 5.22 0 1.44.56 2.8 1.53 3.77.97.97 2.33 1.53 3.77 1.53 1.44 0 2.8-.56 3.77-1.53L12 14.34l1.52 1.51c.97.97 2.33 1.53 3.77 1.53 2.88 0 5.22-2.34 5.22-5.22 0-1.44-.56-2.8-1.53-3.77-.97-.97-2.33-1.53-3.77-1.53z"/></svg>'
    ];
    
    // Advanced mathematical equations
    const mathEquations = [
      // Calculus
      '∫ f(x)dx = F(x) + C',
      'd/dx[x²] = 2x',
      '∂f/∂x + ∂f/∂y = ∇f',
      'lim[x→0] sin(x)/x = 1',
      '∫₀^∞ e^(-x²)dx = √π/2',
      'd/dx[eˣ] = eˣ',
      '∫ 1/x dx = ln|x| + C',
      '∇²f = ∂²f/∂x² + ∂²f/∂y²',
      
      // Logarithmic
      'log_a(xy) = log_a(x) + log_a(y)',
      'ln(e^x) = x',
      'log₁₀(100) = 2',
      'ln(x) = log_e(x)',
      'log_a(x^n) = n·log_a(x)',
      'log_a(1) = 0',
      'a^(log_a(x)) = x',
      'log_a(b) = ln(b)/ln(a)',
      'a^2 + b^2 = c^2',

      // Complex equations
      'e^(iπ) + 1 = 0',
      'F = ma',
      'E = mc²',
      '∑[n=1 to ∞] 1/n²  = π²/6',
      'sin²(x) + cos²(x) = 1',
      'a² + b² = c²',
      'x = (-b ± √(b²-4ac))/2a',
      '∇ × E = -∂B/∂t',
      
      // Mathematical constants and functions
      'π ≈ 3.14159...',
      'e ≈ 2.71828...',
      'φ = (1+√5)/2',
      'γ ≈ 0.57721...',
      'sin(π/2) = 1',
      'cos(0) = 1',
      'tan(π/4) = 1',
      '∫ sin(x)dx = -cos(x) + C'
    ];
    
    const animationClasses = ['float-horizontal', 'float-diagonal', 'float-circular', 'float-vertical', 'float-figure8', 'float-spiral', 'float-wave', 'float-orbit'];
    const mathBg = document.getElementById('mathBackground');
    
    // Create 30 floating math elements (mix of symbols and equations)
    for (let i = 0; i < 30; i++) {
      const element = document.createElement('div');
      element.className = `math-symbol ${animationClasses[Math.floor(Math.random() * animationClasses.length)]}`;
      
      // 70% chance for equations, 30% for symbols
      if (Math.random() > 0.3) {
        // Create equation
        element.innerHTML = mathEquations[Math.floor(Math.random() * mathEquations.length)];
        element.classList.add('math-equation');
        
        // Some equations are larger
        if (Math.random() > 0.6) {
          element.classList.add('large');
        }
      } else {
        // Create symbol
        element.innerHTML = mathSymbols[Math.floor(Math.random() * mathSymbols.length)];
      }
      
      // Random positioning and timing - better distribution
      element.style.left = Math.random() * 100 + '%';
      element.style.top = Math.random() * 100 + '%';
      element.style.animationDelay = (i * 2) + Math.random() * 10 + 's'; // More staggered timing
      element.style.animationDuration = (20 + Math.random() * 30) + 's'; // Variable duration
      element.style.opacity = 0.04 + Math.random() * 0.08;
      
      // Random size variation for symbols only
      if (!element.classList.contains('math-equation')) {
        const scale = 0.8 + Math.random() * 1.4;
        element.style.transform = `scale(${scale})`;
      }
      
      mathBg.appendChild(element);
    }
  }

  /* ---------- BUTTON FUNCTIONALITY ---------- */
  function initializeButtons() {
    // GitHub button
    document.getElementById('githubBtn').addEventListener('click', () => {
      window.open('https://github.com/cbx-nz/new-ruffle.rs-games', '_blank');
    });

    // Math resources button
    document.getElementById('mathBtn').addEventListener('click', () => {
      window.open('https://www.khanacademy.org/math', '_blank');
    });

    // Calculator button
    document.getElementById('calculatorBtn').addEventListener('click', () => {
      window.open('https://www.desmos.com/calculator', '_blank');
    });

    // Settings button
    document.getElementById('settingsBtn').addEventListener('click', () => {
      alert('Settings panel coming soon! 🛠️\n\nThis will include:\n• Animation speed controls\n• Background equation density\n• Theme customization\n• Accessibility options');
    });

    // Developer website button
    document.getElementById('developerBtn').addEventListener('click', () => {
      window.open('https://cbgames-xyz.vercel.app', '_blank');
    });

    // Info button functionality (keeping existing tooltip)
    document.getElementById('infoBtn').addEventListener('click', () => {
      window.open('https://onlinemathsclub.vercel.app/README.md', '_blank');
    });
  }

  /* ---------- RECENT GAMES ---------- */
  function loadRecentGames() {
    const recent = JSON.parse(localStorage.getItem("recentGames") || "[]");
    const recentList = document.getElementById("recentList");
    if (!recentList) return;     // skip if page has no recent list container

    recentList.innerHTML = "";
    recent.forEach(name => {
      const li = document.createElement("li");
      li.textContent = name;
      li.style.cursor = "pointer";
      li.addEventListener("click", () => {
        const option = Array.from(
          document.querySelectorAll("#pages option")
        ).find(o => o.value.toLowerCase() === name.toLowerCase());

        if (option) window.location.href = option.dataset.url;
        else alert("Game not found.");
      });
      recentList.appendChild(li);
    });
  }

  /* ---------- MAIN BOOTSTRAP ---------- */
  window.addEventListener("DOMContentLoaded", () => {
    // Initialize math background
    createMathSymbols();
    
    // Initialize button functionality
    initializeButtons();
    
    const datalist = document.getElementById("pages");
    const input    = document.getElementById("pageInput");

    /* 1. Fetch external option list */
    fetch(optionsURL)
      .then(res => {
        if (!res.ok) throw new Error(`Failed to load ${optionsURL}`);
        return res.text();
      })
      .then(html => {
        datalist.innerHTML = html;

        /* 2. Sort options alphabetically */
        const opts = Array.from(datalist.querySelectorAll("option"));
        opts.sort((a, b) =>
          a.value.toLowerCase().localeCompare(b.value.toLowerCase())
        );
        datalist.innerHTML = "";
        opts.forEach(o => datalist.appendChild(o));

        /* 3. Populate recent game list once options are ready */
        loadRecentGames();
      })
      .catch(err => {
        console.error(err);
        alert("Failed to load game list.");
        loadRecentGames(); // still try to show recents
      });

    /* 4. Form submission handling */
    document.getElementById("pageForm").addEventListener("submit", e => {
      e.preventDefault();
      const typed   = input.value.trim().toLowerCase();
      const options = document.querySelectorAll("#pages option");

      for (const o of options) {
        if (o.value.toLowerCase() === typed) {
          // Maintain recent-games list
          let recent = JSON.parse(localStorage.getItem("recentGames") || "[]");
          recent = recent.filter(v => v.toLowerCase() !== typed);
          recent.unshift(o.value);            // preserve original casing
          if (recent.length > maxRecent) recent.length = maxRecent;
          localStorage.setItem("recentGames", JSON.stringify(recent));

          loadRecentGames();                 // update list before navigation
          window.location.href = o.dataset.url;
          return;
        }
      }
      alert("Please select a valid page from the list.");
    });

    /* 5. Auto-open dropdown on focus */
    input.addEventListener("focus", () => {
      input.dispatchEvent(new KeyboardEvent("keydown", { key: "ArrowDown" }));
    });
  });
</script>
</body>
</html>
